<?php
namespace Segura\SDK\{{ app_name }}\AccessLayer\Base;

use Segura\SDK\{{ app_name }}\Abstracts\AbstractAccessLayer;
use Segura\SDK\{{ app_name }}\Exceptions;
use Segura\SDK\{{ app_name }}\Models;

abstract class Base{{ pack_name }}AccessLayer extends AbstractAccessLayer
{

{% for route in routes %}
{% set test_file = "SDK/AccessLayer/" ~ "_function_" ~ route.function ~ ".php.twig" %}
{% include test_file %}

{% endfor %}

    private function hydrate($raw{{ routes['create'].singular }})
    {
        // if the entity is an array and is empty, return false. Nothing to hydrate.
        if(is_array($raw{{ routes['create'].singular }}) && empty($raw{{ routes['create'].singular }})){
            return false;
        }

        if(
            // If the data given IS an array
            is_array($raw{{ routes['create'].singular }}) &&
            // And Is NOT an associative array
            !(array_keys($raw{{ routes['create'].singular }}) !== range(0, count($raw{{ routes['create'].singular }}) - 1)) &&
            // And is NOT an empty array...
            !count($raw{{ routes['create'].singular }}) == 0
        ){
            // Then we have to hydrate each element. Recursively. Aww yeah.
            $array = [];
            foreach($raw{{ routes['create'].singular }} as $index => ${{ routes['create'].singular|lower }}){
                $array[$index] = $this->hydrate(${{ routes['create'].singular|lower }});
            }
            return $array;
        }else{
            return new Models\{{ routes['create'].singular }}Model($raw{{ routes['create'].singular }});
        }
    }
}
