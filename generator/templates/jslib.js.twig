/**
 * @date {{ date_generated }}
 */

function SeguraApi(){
}

SeguraApi.prototype.setHost = function (base_uri){
    this.base_uri = base_uri;
};

SeguraApi.prototype.doRequest = function(uri, method, body, callback){
    var request = require('request');
    request({
        method: method,
        uri: this.base_uri + "/" + uri
    }, function (error, response, body){
        console.log(error);
        console.log('the decoded data is: ' + body);
        callback(body);
    });
};

SeguraApi.prototype.ping = function(callback){
    return this.doRequest('v1/ping', 'GET', '', callback);
};

{% for model in models %}
/**
 * Model: {{ model.class_name }}
 */
SeguraApi.prototype.list{{ model.class_name }} = function(callback){
    return this.doRequest("v1/{{ model.controller_route }}", "GET", "", callback);
};
SeguraApi.prototype.get{{ model.class_name }} = function(id, callback){
    return this.doRequest("v1/{{ model.controller_route }}/" + id, "GET", "", callback);
};
SeguraApi.prototype.delete{{ model.class_name }} = function(id, callback){
    return this.doRequest("v1/{{ model.controller_route }}/" + id, "DELETE", "", callback);
};

{% endfor %}

var seguraApi = new SeguraApi();

module.exports = {
    setHost: function(host){
        seguraApi.setHost(host)
    },
    api: {
        {% for model in models %}
        list{{ model.class_name }}: function(callback){
            return seguraApi.list{{ model.class_name }}(callback);
        },
        get{{ model.class_name }}: function(callback){
            return seguraApi.get{{ model.class_name }}(callback);
        },
        delete{{ model.class_name }}: function(callback){
            return seguraApi.delete{{ model.class_name }}(callback);
        },
        {% endfor %}
        ping: function(callback){
            return seguraApi.ping(callback);
        }
    },
    getListOfFunctions: function(){
        return [
        {% for model in models %}
            "list{{ model.class_name }}",
            "get{{ model.class_name }}",
            "delete{{ model.class_name }}",
        {% endfor %}
            "ping"
        ];
    }
};