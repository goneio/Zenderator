<?php
$exampleExistingObjectFindFunction = function()
{
    $DIContainer = \{{ app_container }}::Instance()->getContainer();
    $tableGateway = $DIContainer->get(\{{ namespace }}\TableGateways\{{ class_name }}TableGateway::class);
    // @todo This badly needs refactoring to be less insane/db heavy
    /** @var \{{ namespace }}\Models\{{ class_name }}Model $exampleExistingObject */
    $exampleExistingObject = $tableGateway->fetchRandom();

    /** @var \{{ namespace }}\TableGateways\{{ class_name }}TableGateway $exampleExistingObjectTableGateway */
    $exampleExistingObjectTableGateway = $DIContainer->get(\{{ namespace }}\TableGateways\{{ class_name }}TableGateway::class);

    if(!$exampleExistingObject instanceof \{{ namespace }}\Models\{{ class_name }}Model){
        $exampleExistingObject = $exampleExistingObjectTableGateway->getNewMockModelInstance()->save();
        #$exampleExistingObject->destroy();
    }

    /** @var \{{ namespace }}\Models\{{ class_name }}Model $exampleObjectToCreate */
    $exampleObjectToCreate = $exampleExistingObjectTableGateway->getNewMockModelInstance();

    return $exampleExistingObject;
};

// Router proper begins
$router = \Segura\AppCore\Router\Router::Instance()
    ->addRoute(
        \Segura\AppCore\Router\Route::Factory()
            ->setName('{{ class_name }} List')
            ->setCallback(\{{ namespace }}\Controllers\{{ class_name }}Controller::class . ':listRequest')
            ->setSDKClass('{{ class_name }}')
            ->setSDKFunction('list')
            ->setSDKTemplate('list')
            ->setRouterPattern('/v1/{{ controller_route }}')
            ->setHttpEndpoint( '/v1/{{ controller_route }}')
            ->setHttpMethod('GET')
            ->setSingular('{{ object_name_singular }}')
            ->setPlural('{{ object_name_plural }}')
            ->setProperties([
{% for column in columns %}
                '{{ column.getPropertyFunction }}',
{% endfor %}
            ])
            ->setAccess(DEFAULT_ROUTE_ACCESS_MODE)
            ->setExampleEntityFindFunction($exampleExistingObjectFindFunction)
    )
    ->addRoute(
        \Segura\AppCore\Router\Route::Factory()
            ->setName('{{ class_name }} Create')
            ->setCallback(\{{ namespace }}\Controllers\{{ class_name }}Controller::class . ':createRequest')
            ->setSDKClass('{{ class_name }}')
            ->setSDKFunction('create')
            ->setSDKTemplate('create')
            ->setRouterPattern('/v1/{{ controller_route }}')
            ->setHttpEndpoint( '/v1/{{ controller_route }}')
            ->setHttpMethod('PUT')
            ->setSingular('{{ object_name_singular }}')
            ->setPlural('{{ object_name_plural }}')
            ->setProperties([
{% for column in columns %}
                '{{ column.getPropertyFunction }}',
{% endfor %}
            ])
            ->setAccess(DEFAULT_ROUTE_ACCESS_MODE)
            ->setExampleEntityFindFunction($exampleExistingObjectFindFunction)
    )
    ->addRoute(
        \Segura\AppCore\Router\Route::Factory()
            ->setName('{{ class_name }} Get')
            ->setCallback(\{{ namespace }}\Controllers\{{ class_name }}Controller::class . ':getRequest')
            ->setSDKClass('{{ class_name }}')
            ->setSDKFunction('get')
            ->setSDKTemplate('get')
            ->setRouterPattern('/v1/{{ controller_route }}/{id}')
            ->setHttpEndpoint( '/v1/{{ controller_route }}/id')
            ->setHttpMethod('GET')
            ->setSingular('{{ object_name_singular }}')
            ->setPlural('{{ object_name_plural }}')
            ->setProperties([
{% for column in columns %}
                '{{ column.getPropertyFunction }}',
{% endfor %}
            ])
            ->setAccess(DEFAULT_ROUTE_ACCESS_MODE)
            ->setExampleEntityFindFunction($exampleExistingObjectFindFunction)
    )
    ->addRoute(
        \Segura\AppCore\Router\Route::Factory()
            ->setName('{{ class_name }} Delete')
            ->setCallback(\{{ namespace }}\Controllers\{{ class_name }}Controller::class . ':deleteRequest')
            ->setSDKClass('{{ class_name }}')
            ->setSDKFunction('delete')
            ->setSDKTemplate('delete')
            ->setRouterPattern('/v1/{{ controller_route }}/{id}')
            ->setHttpEndpoint( '/v1/{{ controller_route }}/id')
            ->setHttpMethod('DELETE')
            ->setSingular('{{ object_name_singular }}')
            ->setPlural('{{ object_name_plural }}')
            ->setProperties([
{% for column in columns %}
                '{{ column.getPropertyFunction }}',
{% endfor %}
            ])
            ->setAccess(DEFAULT_ROUTE_ACCESS_MODE)
    );


